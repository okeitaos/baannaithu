<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>üõ†Ô∏è Admin - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</title>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-900 text-white p-4">

<h1 class="text-xl font-bold mb-4">üõ†Ô∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h1>

<!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
<div class="bg-slate-800 p-3 rounded mb-4">
  <h2 class="font-bold mb-2">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>

  <input id="pName" placeholder="‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤"
    class="w-full p-2 mb-2 text-black rounded">

  <select id="pCategory" class="w-full p-2 mb-2 text-black rounded">
    <option value="‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ô">‡∏Ç‡∏ô‡∏°‡∏à‡∏µ‡∏ô</option>
    <option value="‡∏ô‡πâ‡∏≥">‡∏ô‡πâ‡∏≥</option>
    <option value="‡∏ó‡∏≤‡∏ô‡πÄ‡∏•‡πà‡∏ô">‡∏ó‡∏≤‡∏ô‡πÄ‡∏•‡πà‡∏ô</option>
  </select>

  <input id="pPrice" type="number" placeholder="‡∏£‡∏≤‡∏Ñ‡∏≤"
    class="w-full p-2 mb-2 text-black rounded">

  <button onclick="addProduct()" class="bg-emerald-600 w-full py-2 rounded">
    ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
  </button>
</div>

<!-- ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ -->
<table class="w-full text-sm">
  <thead>
    <tr class="border-b border-slate-600">
      <th class="text-left py-1">‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</th>
      <th>‡∏£‡∏≤‡∏Ñ‡∏≤</th>
      <th>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
    </tr>
  </thead>
  <tbody id="list"></tbody>
</table>

<script>
const SUPABASE_URL = "https://nvsptbbvxjulrpdebrhn.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im52c3B0YmJ2eGp1bHJwZGVicmhuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc2MTc1NTAsImV4cCI6MjA4MzE5MzU1MH0.sQ8XqdAKCsaxWupP3QZjFOraEHyW8agSo3c3BR3I8ss";
const db = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

async function loadProducts() {
  const { data } = await db.from('products').select('*').order('category');
  list.innerHTML = '';

  data.forEach(p => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td class="py-1">${p.name}</td>
      <td class="text-center">${p.price}</td>
      <td class="text-center">
        <input type="checkbox" ${p.active ? 'checked' : ''}
          onchange="toggleActive('${p.id}', this.checked)">
      </td>
    `;
    list.appendChild(tr);
  });
}

async function toggleActive(id, active) {
  await db.from('products').update({ active }).eq('id', id);
}

async function addProduct() {
  if (!pName.value || !pPrice.value) return alert('‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö');

  await db.from('products').insert({
    name: pName.value,
    category: pCategory.value,
    price: Number(pPrice.value),
    active: true
  });

  pName.value = pPrice.value = '';
  loadProducts();
}

loadProducts();
</script>

</body>
</html>
